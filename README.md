# WMS 拣货路径对比游戏

一个基于网页的WMS（仓库管理系统）拣货路径优化教学游戏。玩家可以规划自己的拣货路线，并与AI算法进行对比，学习路径优化的原理。

## 🎮 游戏特性

### 核心功能
- ✅ 18×18 可配置网格地图
- ✅ 随机生成拣货任务（货物数量、位置、重量）
- ✅ 小车载重限制与卸货机制
- ✅ 玩家手动规划路线
- ✅ AI自动规划路径（A*算法 + 容量约束优化）
- ✅ 实时动画演示与路径对比
- ✅ 详细的统计数据与效率分析

### 界面设计
- 🎨 绿色主题配色
- 📊 三栏布局：AI面板、地图视图、玩家面板
- 🚗 双车并行动画（AI车 vs 玩家车）
- 📈 实时显示步数、时间、载重、卸货次数

### AI算法
- 🧠 使用 **A*寻路算法** 计算最短路径
- 📦 容量约束的拣货顺序优化（类似CVRP问题）
- 🎯 最近邻启发式 + 重量优化策略
- 💡 提供决策过程解释（教学模式）

## 🚀 快速开始

### 方法1：直接运行（推荐）
1. 用浏览器打开 `index.html` 文件即可开始游戏
2. 无需安装任何依赖，纯前端实现

### 方法2：本地服务器
```bash
# 使用Python启动本地服务器
python3 -m http.server 8000

# 或使用Node.js
npx http-server -p 8000

# 然后访问 http://localhost:8000
```

## 📖 游戏规则

### 基本规则
1. **起点**：小车从左上角(0,0)出发
2. **任务**：拣取地图上所有货物
3. **移动规则**：只能上下左右移动（不能走斜线），使用A*算法自动规划最短路径
4. **载重限制**：小车有最大载重限制（默认200kg）
5. **自动卸货**：当下一个货物会导致超载时，系统会自动让小车返回原点卸货
6. **终点**：完成所有拣货后返回原点

### 游戏流程
1. 点击"生成新任务"创建随机关卡
2. 在地图上点击货物，按顺序规划你的拣货路线
3. 点击"开始对比"观看AI和玩家路径的并行演示
4. 查看对比结果，分析效率差异

### 胜利条件
- 步数少于AI = 优秀
- 步数接近AI（±10%）= 良好
- 步数比AI多 = 需要优化

## ⚙️ 配置说明

游戏提供了丰富的配置选项，所有配置都可以在界面上实时修改：

### 配置项说明

| 配置项 | 默认值 | 说明 | 可调范围 |
|--------|--------|------|----------|
| `gridSize` | 18 | 网格大小（N×N） | 10-30 |
| `cellPx` | 32 | 每格像素大小 | 固定 |
| `itemCountMin` | 10 | 最少货物数量 | 5-30 |
| `itemCountMax` | 15 | 最多货物数量 | 5-30 |
| `itemWeightRange` | [10, 90] | 货物重量范围 | 固定 |
| `vehicleCapacity` | 200 | 小车载重容量 | 20-500 |
| `moveSpeedCellsPerSecond` | 5 | 移动速度（格/秒） | 1-20 |
| `seed` | 12345 | 随机种子（可重放） | 任意整数 |
| `unloadTime` | 1000 | 卸货时间（毫秒） | 固定 |

### 修改配置方式

#### 方法1：界面修改
在左侧"游戏配置"面板中直接修改输入框的值

#### 方法2：代码修改
编辑 `index.html` 文件中的配置对象：

```javascript
let CONFIG = {
    gridSize: 18,              // 修改为你想要的网格大小
    cellPx: 32,
    itemCountMin: 10,          // 修改货物数量范围
    itemCountMax: 15,
    itemWeightRange: [10, 90],
    vehicleCapacity: 200,      // 修改为20可以增加难度
    moveSpeedCellsPerSecond: 5,
    seed: 12345,
    unloadTime: 1000
};
```

### 配置示例

#### 简单模式（新手友好）
```javascript
itemCountMin: 5
itemCountMax: 8
vehicleCapacity: 300
moveSpeedCellsPerSecond: 3
```

#### 困难模式（挑战AI）
```javascript
itemCountMin: 15
itemCountMax: 20
vehicleCapacity: 150
moveSpeedCellsPerSecond: 8
```

#### 极限模式
```javascript
itemCountMin: 20
itemCountMax: 25
vehicleCapacity: 100
gridSize: 24
```

## 🎯 操作指南

### 鼠标操作
- **点击货物**：将货物添加到拣货路线
- **点击删除按钮**：从路线中移除货物

### 按钮说明
- **生成新任务**：创建新的随机关卡
- **开始对比**：启动AI和玩家路径的并行演示
- **暂停/继续**：暂停或继续动画
- **重置**：重置当前游戏状态
- **示例关卡**：加载预设的示例关卡
- **清空路线**：清除所有已规划的路线
- **撤销**：撤销最后添加的货物

## 📊 评分系统

### 评估指标
1. **总步数**：从起点到终点经过的格子数
2. **总时间**：完成任务所需的时间（秒）
3. **卸货次数**：返回原点卸货的次数
4. **效率提升率** = (玩家步数 - AI步数) / AI步数 × 100%

### 评级标准
- 🏆 **优秀**：效率 ≤ 0%（玩家更优）
- 👍 **良好**：效率 0-10%
- 😊 **还可以**：效率 10-30%
- 💪 **继续努力**：效率 > 30%

## 🤖 AI算法详解

### 算法流程

#### 1. A*寻路算法
- 用于计算两点之间的最短路径（只允许上下左右移动）
- 考虑曼哈顿距离作为启发函数
- 保证找到最优路径
- 不支持斜向移动，确保路径符合仓库实际操作

#### 2. 容量约束的拣货顺序
```
while 还有未拣货物:
    找到所有当前载重可拣的货物（不超载）
    
    if 没有可拣货物:
        返回原点卸货
        继续
    
    选择最近的货物（考虑距离 + 重量启发）
    拣取该货物
    更新当前载重
```

#### 3. 启发式优化
- **距离优先**：优先选择距离近的货物
- **重量考虑**：轻微惩罚重货物，鼓励先拣轻货物
- **前瞻机制**：避免导致频繁卸货的选择

### 教学模式
点击"查看AI决策过程"可以看到每一步的决策理由：
```
步骤 0: 开始位置: (0,0), 载重容量: 200
步骤 1: 选择货物 item4 (7,2) 重量30，距离9
步骤 2: 选择货物 item1 (3,5) 重量40，距离7
步骤 3: 当前载重190，无法拣取剩余货物，返回原点卸货
...
```

## 🎓 优化技巧

### 新手建议
1. **就近原则**：优先拣取距离近的货物
2. **满载优化**：尽量让每次出行接近满载
3. **减少空跑**：规划路线时考虑顺路拣货
4. **避免回头**：尽量不走重复的路径

### 进阶策略
1. **分区拣货**：将地图分为几个区域，逐区完成
2. **重量平衡**：轻重货物搭配，最大化单次出行效率
3. **路径压缩**：选择能形成较短路径的货物组合
4. **动态调整**：根据当前位置和载重动态选择下一个目标

## 🔧 技术栈

- **纯前端实现**：HTML + CSS + JavaScript
- **无依赖**：不需要任何外部库或框架
- **响应式设计**：适配不同屏幕尺寸
- **Canvas绘图**：高性能2D图形渲染

## 📁 文件说明

```
wms_jianhuo_cursor/
├── index.html              # 主游戏文件（可直接运行）
├── example-level.json      # 示例关卡配置
└── README.md              # 本说明文档
```

## ⚡ 重要特性

### 1. 严格的网格移动
- 小车只能**上下左右**移动，**不能走斜线**
- 这符合真实仓库拣货小车的移动规则
- A*算法只计算四个方向的邻居节点
- 所有路径都是沿着网格边缘的曼哈顿路径

### 2. 智能超载处理
- 玩家规划路线时**不需要手动插入卸货点**
- 系统会自动检测：如果下一个货物导致超载
- 自动在路径中插入"返回原点卸货"动作
- AI和玩家使用相同的超载处理逻辑，确保公平对比

**示例**：
- 当前载重：150kg，容量：200kg
- 下一个货物：60kg
- 判断：150 + 60 = 210 > 200（超载）
- 动作：先返回原点卸货（载重归零），再去拣取该货物

## 🐛 已知限制

1. **不支持关卡导入**：暂不支持加载JSON配置文件
2. **动画不可跳过**：必须等待动画完成才能查看结果
3. **不支持多车**：目前只支持单车拣货

## 🔮 未来扩展

- [ ] 支持JSON关卡导入/导出
- [ ] 多种AI算法对比（贪心、遗传算法、模拟退火等）
- [ ] 多车协同拣货
- [ ] 障碍物和复杂地形
- [ ] 在线排行榜
- [ ] 移动端触控优化
- [ ] 关卡编辑器

## 📞 反馈与支持

如有问题或建议，请通过以下方式反馈：
- 提交Issue到项目仓库
- 联系开发团队

## 📄 许可

本项目仅供学习和教学使用。

---

**享受游戏，挑战AI，成为拣货路径优化大师！** 🚀

